<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Causality â€¢ qss</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">qss</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/causality.html">Causality</a>
    </li>
    <li>
      <a href="../articles/discovery.html">Discovery</a>
    </li>
    <li>
      <a href="../articles/intro.html">Intro</a>
    </li>
    <li>
      <a href="../articles/measurement.html">Measurement</a>
    </li>
    <li>
      <a href="../articles/prediction.html">Prediction</a>
    </li>
    <li>
      <a href="../articles/probability.html">Probability</a>
    </li>
    <li>
      <a href="../articles/uncertainty.html">Uncertainty</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Causality</h1>
            
          </div>

    
    
<div class="contents">
<div id="chapter-2-causality" class="section level1">
<h1 class="hasAnchor">
<a href="#chapter-2-causality" class="anchor"></a>Chapter 2: Causality</h1>
<div id="section-2-1-racial-discrimination-in-the-labor-market" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-1-racial-discrimination-in-the-labor-market" class="anchor"></a>Section 2.1: Racial Discrimination in the Labor Market</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"resume"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)

<span class="kw">dim</span>(resume)</code></pre>
<pre><code>## [1] 4870    4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(resume)</code></pre>
<pre><code>##   firstname    sex  race call
## 1   Allison female white    0
## 2   Kristen female white    0
## 3   Lakisha female black    0
## 4   Latonya female black    0
## 5    Carrie female white    0
## 6       Jay   male white    0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(resume)</code></pre>
<pre><code>##   firstname             sex                race          
##  Length:4870        Length:4870        Length:4870       
##  Class :character   Class :character   Class :character  
##  Mode  :character   Mode  :character   Mode  :character  
##                                                          
##                                                          
##                                                          
##       call        
##  Min.   :0.00000  
##  1st Qu.:0.00000  
##  Median :0.00000  
##  Mean   :0.08049  
##  3rd Qu.:0.00000  
##  Max.   :1.00000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">race.call.tab &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="dt">race =</span> resume$race, <span class="dt">call =</span> resume$call)
race.call.tab</code></pre>
<pre><code>##        call
## race       0    1
##   black 2278  157
##   white 2200  235</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">addmargins</span>(race.call.tab)</code></pre>
<pre><code>##        call
## race       0    1  Sum
##   black 2278  157 2435
##   white 2200  235 2435
##   Sum   4478  392 4870</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## overall callback rate: total callbacks divided by the sample size
<span class="kw">sum</span>(race.call.tab[, <span class="dv">2</span>]) /<span class="st"> </span><span class="kw">nrow</span>(resume)</code></pre>
<pre><code>## [1] 0.08049281</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## callback rates for each race
race.call.tab[<span class="dv">1</span>, <span class="dv">2</span>] /<span class="st"> </span><span class="kw">sum</span>(race.call.tab[<span class="dv">1</span>, ]) <span class="co"># black</span></code></pre>
<pre><code>## [1] 0.06447639</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">race.call.tab[<span class="dv">2</span>, <span class="dv">2</span>] /<span class="st"> </span><span class="kw">sum</span>(race.call.tab[<span class="dv">2</span>, ]) <span class="co"># white</span></code></pre>
<pre><code>## [1] 0.09650924</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">race.call.tab[<span class="dv">1</span>, ]  <span class="co"># the first row</span></code></pre>
<pre><code>##    0    1 
## 2278  157</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">race.call.tab[, <span class="dv">2</span>]  <span class="co"># the second column</span></code></pre>
<pre><code>## black white 
##   157   235</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(resume$call)</code></pre>
<pre><code>## [1] 0.08049281</code></pre>
</div>
<div id="section-2-2-subsetting-the-data-in-r" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-2-subsetting-the-data-in-r" class="anchor"></a>Section 2.2: Subsetting the Data in R</h2>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(<span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] "logical"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.integer</span>(<span class="ot">TRUE</span>)</code></pre>
<pre><code>## [1] 1</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.integer</span>(<span class="ot">FALSE</span>)</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>) <span class="co"># a vector with logical values</span>

<span class="kw">mean</span>(x) <span class="co"># proportion of TRUEs</span></code></pre>
<pre><code>## [1] 0.6666667</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(x) <span class="co"># number of TRUEs</span></code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="ot">FALSE</span> &amp;<span class="st"> </span><span class="ot">TRUE</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="ot">TRUE</span> &amp;<span class="st"> </span><span class="ot">TRUE</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="ot">TRUE</span> |<span class="st"> </span><span class="ot">FALSE</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="ot">FALSE</span> |<span class="st"> </span><span class="ot">FALSE</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="ot">TRUE</span> &amp;<span class="st"> </span><span class="ot">FALSE</span> &amp;<span class="st"> </span><span class="ot">TRUE</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="ot">TRUE</span> |<span class="st"> </span><span class="ot">FALSE</span>) &amp;<span class="st"> </span><span class="ot">FALSE</span> <span class="co"># the parentheses evaluate to TRUE</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="ot">TRUE</span> |<span class="st"> </span>(<span class="ot">FALSE</span> &amp;<span class="st"> </span><span class="ot">FALSE</span>) <span class="co"># the parentheses evaluate to FALSE</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">TF1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)
TF2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>)
TF1 |<span class="st"> </span>TF2</code></pre>
<pre><code>## [1]  TRUE FALSE  TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">TF1 &amp;<span class="st"> </span>TF2</code></pre>
<pre><code>## [1]  TRUE FALSE FALSE</code></pre>
<div id="section-2-2-2-relational-operators" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-2-2-relational-operators" class="anchor"></a>Section 2.2.2: Relational Operators</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="dv">4</span> &gt;<span class="st"> </span><span class="dv">3</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="st">"Hello"</span> ==<span class="st"> "hello"</span>  <span class="co"># R is case-sensitive</span></code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="st">"Hello"</span> !=<span class="st"> "hello"</span></code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, -<span class="dv">2</span>, -<span class="dv">1</span>)
x &gt;=<span class="st"> </span><span class="dv">2</span></code></pre>
<pre><code>## [1]  TRUE  TRUE FALSE FALSE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x !=<span class="st"> </span><span class="dv">1</span></code></pre>
<pre><code>## [1]  TRUE  TRUE FALSE  TRUE  TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## logical conjunction of two vectors with logical values
(x &gt;<span class="st"> </span><span class="dv">0</span>) &amp;<span class="st"> </span>(x &lt;=<span class="st"> </span><span class="dv">2</span>)</code></pre>
<pre><code>## [1] FALSE  TRUE  TRUE FALSE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## logical disjunction of two vectors with logical values
(x &gt;<span class="st"> </span><span class="dv">2</span>) |<span class="st"> </span>(x &lt;=<span class="st"> </span>-<span class="dv">1</span>)</code></pre>
<pre><code>## [1]  TRUE FALSE FALSE  TRUE  TRUE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">x.int &lt;-<span class="st"> </span>(x &gt;<span class="st"> </span><span class="dv">0</span>) &amp;<span class="st"> </span>(x &lt;=<span class="st"> </span><span class="dv">2</span>) <span class="co"># logical vector</span>
x.int</code></pre>
<pre><code>## [1] FALSE  TRUE  TRUE FALSE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(x.int) <span class="co"># proportion of TRUEs</span></code></pre>
<pre><code>## [1] 0.4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(x.int)  <span class="co"># number of TRUEs</span></code></pre>
<pre><code>## [1] 2</code></pre>
</div>
<div id="section-2-2-3-subsetting" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-2-3-subsetting" class="anchor"></a>Section 2.2.3: Subsetting</h3>
<pre class="sourceCode r"><code class="sourceCode r">## callback rate for black-sounding names
<span class="kw">mean</span>(resume$call[resume$race ==<span class="st"> "black"</span>])</code></pre>
<pre><code>## [1] 0.06447639</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## race of first 5 observations
resume$race[<span class="dv">1</span>:<span class="dv">5</span>]</code></pre>
<pre><code>## [1] "white" "white" "black" "black" "white"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## comparison of first 5 observations
(resume$race ==<span class="st"> "black"</span>)[<span class="dv">1</span>:<span class="dv">5</span>]</code></pre>
<pre><code>## [1] FALSE FALSE  TRUE  TRUE FALSE</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(resume) <span class="co"># dimension of original data frame</span></code></pre>
<pre><code>## [1] 4870    4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## subset blacks only
resumeB &lt;-<span class="st"> </span>resume[resume$race ==<span class="st"> "black"</span>, ]
<span class="kw">dim</span>(resumeB) <span class="co"># this data.frame has fewer rows than the original data.frame</span></code></pre>
<pre><code>## [1] 2435    4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(resumeB$call) <span class="co"># callback rate for blacks</span></code></pre>
<pre><code>## [1] 0.06447639</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## keep "call" and "firstname" variables
## also keep observations with black female-sounding names
resumeBf &lt;-<span class="st"> </span><span class="kw">subset</span>(resume, <span class="dt">select =</span> <span class="kw">c</span>(<span class="st">"call"</span>, <span class="st">"firstname"</span>),
                   <span class="dt">subset =</span> (race ==<span class="st"> "black"</span> &amp;<span class="st"> </span>sex ==<span class="st"> "female"</span>))
<span class="kw">head</span>(resumeBf)</code></pre>
<pre><code>##    call firstname
## 3     0   Lakisha
## 4     0   Latonya
## 8     0     Kenya
## 9     0   Latonya
## 11    0     Aisha
## 13    0     Aisha</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## ## an alternative syntax with the same results
## resumeBf &lt;- resume[resume$race == "black" &amp; resume$sex == "female",
##                    c("call", "firstname")]
## black male
resumeBm &lt;-<span class="st"> </span><span class="kw">subset</span>(resume, <span class="dt">subset =</span> (race ==<span class="st"> "black"</span>) &amp;<span class="st"> </span>(sex ==<span class="st"> "male"</span>))
## white female
resumeWf &lt;-<span class="st"> </span><span class="kw">subset</span>(resume, <span class="dt">subset =</span> (race ==<span class="st"> "white"</span>) &amp;<span class="st"> </span>(sex ==<span class="st"> "female"</span>))
## white male
resumeWm &lt;-<span class="st"> </span><span class="kw">subset</span>(resume, <span class="dt">subset =</span> (race ==<span class="st"> "white"</span>) &amp;<span class="st"> </span>(sex ==<span class="st"> "male"</span>))
## racial gaps
<span class="kw">mean</span>(resumeWf$call) -<span class="st"> </span><span class="kw">mean</span>(resumeBf$call) <span class="co"># among females</span></code></pre>
<pre><code>## [1] 0.03264689</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(resumeWm$call) -<span class="st"> </span><span class="kw">mean</span>(resumeBm$call) <span class="co"># among males</span></code></pre>
<pre><code>## [1] 0.03040786</code></pre>
</div>
<div id="section-2-2-4-simple-conditional-statements" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-2-4-simple-conditional-statements" class="anchor"></a>Section 2.2.4: Simple Conditional Statements</h3>
<pre class="sourceCode r"><code class="sourceCode r">resume$BlackFemale &lt;-<span class="st"> </span><span class="kw">ifelse</span>(resume$race ==<span class="st"> "black"</span> &amp;
<span class="st">                                 </span>resume$sex ==<span class="st"> "female"</span>, <span class="dv">1</span>, <span class="dv">0</span>)
<span class="kw">table</span>(<span class="dt">race =</span> resume$race, <span class="dt">sex =</span> resume$sex,
      <span class="dt">BlackFemale =</span> resume$BlackFemale)</code></pre>
<pre><code>## , , BlackFemale = 0
## 
##        sex
## race    female male
##   black      0  549
##   white   1860  575
## 
## , , BlackFemale = 1
## 
##        sex
## race    female male
##   black   1886    0
##   white      0    0</code></pre>
</div>
<div id="section-2-2-5-factor-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-2-5-factor-variables" class="anchor"></a>Section 2.2.5: Factor Variables</h3>
<pre class="sourceCode r"><code class="sourceCode r">resume$type &lt;-<span class="st"> </span><span class="ot">NA</span>
resume$type[resume$race ==<span class="st"> "black"</span> &amp;<span class="st"> </span>resume$sex ==<span class="st"> "female"</span>] &lt;-<span class="st"> "BlackFemale"</span>
resume$type[resume$race ==<span class="st"> "black"</span> &amp;<span class="st"> </span>resume$sex ==<span class="st"> "male"</span>] &lt;-<span class="st"> "BlackMale"</span>
resume$type[resume$race ==<span class="st"> "white"</span> &amp;<span class="st"> </span>resume$sex ==<span class="st"> "female"</span>] &lt;-<span class="st"> "WhiteFemale"</span>
resume$type[resume$race ==<span class="st"> "white"</span> &amp;<span class="st"> </span>resume$sex ==<span class="st"> "male"</span>] &lt;-<span class="st"> "WhiteMale"</span>

## check object class
<span class="kw">class</span>(resume$type)</code></pre>
<pre><code>## [1] "character"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## coerce new character variable into a factor variable
resume$type &lt;-<span class="st"> </span><span class="kw">as.factor</span>(resume$type)
## list all levels of a factor variable
<span class="kw">levels</span>(resume$type)</code></pre>
<pre><code>## [1] "BlackFemale" "BlackMale"   "WhiteFemale" "WhiteMale"</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## obtain the number of observations for each level
<span class="kw">table</span>(resume$type)</code></pre>
<pre><code>## 
## BlackFemale   BlackMale WhiteFemale   WhiteMale 
##        1886         549        1860         575</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(resume$call, resume$type, mean)</code></pre>
<pre><code>## BlackFemale   BlackMale WhiteFemale   WhiteMale 
##  0.06627784  0.05828780  0.09892473  0.08869565</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## turn first name into a factor variable
resume$firstname &lt;-<span class="st"> </span><span class="kw">as.factor</span>(resume$firstname)
## compute callback rate for each first name
callback.name &lt;-<span class="st"> </span><span class="kw">tapply</span>(resume$call, resume$firstname, mean)
## sort the result in the increasing order
<span class="kw">sort</span>(callback.name)</code></pre>
<pre><code>##      Aisha    Rasheed     Keisha   Tremayne     Kareem    Darnell 
## 0.02222222 0.02985075 0.03825137 0.04347826 0.04687500 0.04761905 
##     Tyrone      Hakim     Tamika    Lakisha    Tanisha       Todd 
## 0.05333333 0.05454545 0.05468750 0.05500000 0.05797101 0.05882353 
##      Jamal       Neil      Brett   Geoffrey    Brendan       Greg 
## 0.06557377 0.06578947 0.06779661 0.06779661 0.07692308 0.07843137 
##      Emily       Anne       Jill     Latoya      Kenya    Matthew 
## 0.07929515 0.08264463 0.08374384 0.08407080 0.08673469 0.08955224 
##    Latonya      Leroy    Allison      Ebony   Jermaine     Laurie 
## 0.09130435 0.09375000 0.09482759 0.09615385 0.09615385 0.09743590 
##      Sarah   Meredith     Carrie    Kristen        Jay       Brad 
## 0.09844560 0.10160428 0.13095238 0.13145540 0.13432836 0.15873016</code></pre>
</div>
</div>
<div id="section-2-3-causal-effects-and-the-counterfactual" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-3-causal-effects-and-the-counterfactual" class="anchor"></a>Section 2.3: Causal Effects and the Counterfactual</h2>
<pre class="sourceCode r"><code class="sourceCode r">resume[<span class="dv">1</span>, ]</code></pre>
<pre><code>##   firstname    sex  race call BlackFemale        type
## 1   Allison female white    0           0 WhiteFemale</code></pre>
</div>
<div id="section-2-4-randomized-controlled-trials" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-4-randomized-controlled-trials" class="anchor"></a>Section 2.4: Randomized Controlled Trials</h2>
<div id="section-2-4-1-the-role-of-randomization" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-4-1-the-role-of-randomization" class="anchor"></a>Section 2.4.1: The Role of Randomization</h3>
</div>
<div id="section-2-4-2-social-pressure-and-voter-turnout" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-4-2-social-pressure-and-voter-turnout" class="anchor"></a>Section 2.4.2: Social Pressure and Voter Turnout</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"social"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>) <span class="co"># load the data</span>

<span class="kw">summary</span>(social) <span class="co"># summarize the data</span></code></pre>
<pre><code>##      sex             yearofbirth    primary2004       messages        
##  Length:305866      Min.   :1900   Min.   :0.0000   Length:305866     
##  Class :character   1st Qu.:1947   1st Qu.:0.0000   Class :character  
##  Mode  :character   Median :1956   Median :0.0000   Mode  :character  
##                     Mean   :1956   Mean   :0.4014                     
##                     3rd Qu.:1965   3rd Qu.:1.0000                     
##                     Max.   :1986   Max.   :1.0000                     
##   primary2006         hhsize     
##  Min.   :0.0000   Min.   :1.000  
##  1st Qu.:0.0000   1st Qu.:2.000  
##  Median :0.0000   Median :2.000  
##  Mean   :0.3122   Mean   :2.184  
##  3rd Qu.:1.0000   3rd Qu.:2.000  
##  Max.   :1.0000   Max.   :8.000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## turnout for each group
<span class="kw">tapply</span>(social$primary2006, social$messages, mean)</code></pre>
<pre><code>## Civic Duty    Control  Hawthorne  Neighbors 
##  0.3145377  0.2966383  0.3223746  0.3779482</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## turnout for control group
<span class="kw">mean</span>(social$primary2006[social$messages ==<span class="st"> "Control"</span>])</code></pre>
<pre><code>## [1] 0.2966383</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## subtract control group turnout from each group
<span class="kw">tapply</span>(social$primary2006, social$messages, mean) -
<span class="st">    </span><span class="kw">mean</span>(social$primary2006[social$messages ==<span class="st"> "Control"</span>])</code></pre>
<pre><code>## Civic Duty    Control  Hawthorne  Neighbors 
## 0.01789934 0.00000000 0.02573631 0.08130991</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">social$age &lt;-<span class="st"> </span><span class="dv">2006</span> -<span class="st"> </span>social$yearofbirth <span class="co"># create age variable</span>
<span class="kw">tapply</span>(social$age, social$messages, mean)</code></pre>
<pre><code>## Civic Duty    Control  Hawthorne  Neighbors 
##   49.65904   49.81355   49.70480   49.85294</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(social$primary2004, social$messages, mean)</code></pre>
<pre><code>## Civic Duty    Control  Hawthorne  Neighbors 
##  0.3994453  0.4003388  0.4032300  0.4066647</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tapply</span>(social$hhsize, social$messages, mean)</code></pre>
<pre><code>## Civic Duty    Control  Hawthorne  Neighbors 
##   2.189126   2.183667   2.180138   2.187770</code></pre>
</div>
</div>
<div id="section-2-5-observational-studies" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-5-observational-studies" class="anchor"></a>Section 2.5: Observational Studies</h2>
<div id="section-2-5-1-minimum-wage-and-unemployment" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-5-1-minimum-wage-and-unemployment" class="anchor"></a>Section 2.5.1: Minimum Wage and Unemployment</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"minwage"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>) <span class="co"># load the data</span>

<span class="kw">dim</span>(minwage) <span class="co"># dimension of data</span></code></pre>
<pre><code>## [1] 358   8</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(minwage) <span class="co"># summary of data</span></code></pre>
<pre><code>##     chain             location           wageBefore      wageAfter    
##  Length:358         Length:358         Min.   :4.250   Min.   :4.250  
##  Class :character   Class :character   1st Qu.:4.250   1st Qu.:5.050  
##  Mode  :character   Mode  :character   Median :4.500   Median :5.050  
##                                        Mean   :4.618   Mean   :4.994  
##                                        3rd Qu.:4.987   3rd Qu.:5.050  
##                                        Max.   :5.750   Max.   :6.250  
##    fullBefore       fullAfter        partBefore      partAfter    
##  Min.   : 0.000   Min.   : 0.000   Min.   : 0.00   Min.   : 0.00  
##  1st Qu.: 2.125   1st Qu.: 2.000   1st Qu.:11.00   1st Qu.:11.00  
##  Median : 6.000   Median : 6.000   Median :16.25   Median :17.00  
##  Mean   : 8.475   Mean   : 8.362   Mean   :18.75   Mean   :18.69  
##  3rd Qu.:12.000   3rd Qu.:12.000   3rd Qu.:25.00   3rd Qu.:25.00  
##  Max.   :60.000   Max.   :40.000   Max.   :60.00   Max.   :60.00</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## subsetting the data into two states
minwageNJ &lt;-<span class="st"> </span><span class="kw">subset</span>(minwage, <span class="dt">subset =</span> (location !=<span class="st"> "PA"</span>))
minwagePA &lt;-<span class="st"> </span><span class="kw">subset</span>(minwage, <span class="dt">subset =</span> (location ==<span class="st"> "PA"</span>))

## proportion of restaurants whose wage is less than $5.05
<span class="kw">mean</span>(minwageNJ$wageBefore &lt;<span class="st"> </span><span class="fl">5.05</span>) <span class="co"># NJ before</span></code></pre>
<pre><code>## [1] 0.9106529</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(minwageNJ$wageAfter &lt;<span class="st"> </span><span class="fl">5.05</span>)  <span class="co"># NJ after</span></code></pre>
<pre><code>## [1] 0.003436426</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(minwagePA$wageBefore &lt;<span class="st"> </span><span class="fl">5.05</span>) <span class="co"># PA before</span></code></pre>
<pre><code>## [1] 0.9402985</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(minwagePA$wageAfter &lt;<span class="st"> </span><span class="fl">5.05</span>)  <span class="co"># PA after</span></code></pre>
<pre><code>## [1] 0.9552239</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## create a variable for proportion of full-time employees in NJ and PA
minwageNJ$fullPropAfter &lt;-<span class="st"> </span>minwageNJ$fullAfter /
<span class="st">    </span>(minwageNJ$fullAfter +<span class="st"> </span>minwageNJ$partAfter)
minwagePA$fullPropAfter &lt;-<span class="st"> </span>minwagePA$fullAfter /
<span class="st">    </span>(minwagePA$fullAfter +<span class="st"> </span>minwagePA$partAfter)

## compute the difference in means
<span class="kw">mean</span>(minwageNJ$fullPropAfter) -<span class="st"> </span><span class="kw">mean</span>(minwagePA$fullPropAfter)</code></pre>
<pre><code>## [1] 0.04811886</code></pre>
</div>
<div id="section-2-5-2-confounding-bias" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-5-2-confounding-bias" class="anchor"></a>Section 2.5.2: Confounding Bias</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(minwageNJ$chain))</code></pre>
<pre><code>## 
## burgerking        kfc       roys     wendys 
##  0.4054983  0.2233677  0.2508591  0.1202749</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(minwagePA$chain))</code></pre>
<pre><code>## 
## burgerking        kfc       roys     wendys 
##  0.4626866  0.1492537  0.2238806  0.1641791</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## subset Burger King only
minwageNJ.bk &lt;-<span class="st"> </span><span class="kw">subset</span>(minwageNJ, <span class="dt">subset =</span> (chain ==<span class="st"> "burgerking"</span>))
minwagePA.bk &lt;-<span class="st"> </span><span class="kw">subset</span>(minwagePA, <span class="dt">subset =</span> (chain ==<span class="st"> "burgerking"</span>))

## comparison of full-time employment rates
<span class="kw">mean</span>(minwageNJ.bk$fullPropAfter) -<span class="st"> </span><span class="kw">mean</span>(minwagePA.bk$fullPropAfter)</code></pre>
<pre><code>## [1] 0.03643934</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">minwageNJ.bk.subset &lt;-
<span class="st">    </span><span class="kw">subset</span>(minwageNJ.bk, <span class="dt">subset =</span> ((location !=<span class="st"> "shoreNJ"</span>) &amp;
<span class="st">                                       </span>(location !=<span class="st"> "centralNJ"</span>)))

<span class="kw">mean</span>(minwageNJ.bk.subset$fullPropAfter) -<span class="st"> </span><span class="kw">mean</span>(minwagePA.bk$fullPropAfter)</code></pre>
<pre><code>## [1] 0.03149853</code></pre>
</div>
<div id="section-2-5-3-before-and-after-and-difference-in-differences-designs" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-5-3-before-and-after-and-difference-in-differences-designs" class="anchor"></a>Section 2.5.3: Before-and-After and Difference-in-Differences Designs</h3>
<pre class="sourceCode r"><code class="sourceCode r">## full-time employment proportion in the previous period for NJ
minwageNJ$fullPropBefore &lt;-<span class="st"> </span>minwageNJ$fullBefore /
<span class="st">    </span>(minwageNJ$fullBefore +<span class="st"> </span>minwageNJ$partBefore)

## mean difference between before and after the minimum wage increase
NJdiff &lt;-<span class="st"> </span><span class="kw">mean</span>(minwageNJ$fullPropAfter) -<span class="st"> </span><span class="kw">mean</span>(minwageNJ$fullPropBefore)
NJdiff</code></pre>
<pre><code>## [1] 0.02387474</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## full-time employment proportion in the previous period for PA
minwagePA$fullPropBefore &lt;-<span class="st"> </span>minwagePA$fullBefore /
<span class="st">    </span>(minwagePA$fullBefore +<span class="st"> </span>minwagePA$partBefore)
## mean difference between before and after for PA
PAdiff &lt;-<span class="st"> </span><span class="kw">mean</span>(minwagePA$fullPropAfter) -<span class="st"> </span><span class="kw">mean</span>(minwagePA$fullPropBefore)
## difference-in-differences
NJdiff -<span class="st"> </span>PAdiff</code></pre>
<pre><code>## [1] 0.06155831</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## full-time employment proportion in the previous period for PA
minwagePA$fullPropBefore &lt;-<span class="st"> </span>minwagePA$fullBefore /
<span class="st">    </span>(minwagePA$fullBefore +<span class="st"> </span>minwagePA$partBefore)
## mean difference between before and after for PA
PAdiff &lt;-<span class="st"> </span><span class="kw">mean</span>(minwagePA$fullPropAfter) -<span class="st"> </span><span class="kw">mean</span>(minwagePA$fullPropBefore)
## difference-in-differences
NJdiff -<span class="st"> </span>PAdiff</code></pre>
<pre><code>## [1] 0.06155831</code></pre>
</div>
</div>
<div id="section-2-6-descriptive-statistics-for-a-single-variable" class="section level2">
<h2 class="hasAnchor">
<a href="#section-2-6-descriptive-statistics-for-a-single-variable" class="anchor"></a>Section 2.6: Descriptive Statistics for a Single Variable</h2>
<div id="section-2-6-1-quantiles" class="section level3">
<h3 class="hasAnchor">
<a href="#section-2-6-1-quantiles" class="anchor"></a>Section 2.6.1: Quantiles</h3>
<pre class="sourceCode r"><code class="sourceCode r">## cross-section comparison between NJ and PA
<span class="kw">median</span>(minwageNJ$fullPropAfter) -<span class="st"> </span><span class="kw">median</span>(minwagePA$fullPropAfter)</code></pre>
<pre><code>## [1] 0.07291667</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## before and after comparison
NJdiff.med &lt;-<span class="st"> </span><span class="kw">median</span>(minwageNJ$fullPropAfter) -
<span class="st">    </span><span class="kw">median</span>(minwageNJ$fullPropBefore)
NJdiff.med</code></pre>
<pre><code>## [1] 0.025</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## median difference-in-differences
PAdiff.med &lt;-<span class="st"> </span><span class="kw">median</span>(minwagePA$fullPropAfter) -
<span class="st">    </span><span class="kw">median</span>(minwagePA$fullPropBefore)
NJdiff.med -<span class="st"> </span>PAdiff.med</code></pre>
<pre><code>## [1] 0.03701923</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## summary shows quartiles as well as minimum, maximum, and mean
<span class="kw">summary</span>(minwageNJ$wageBefore)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    4.25    4.25    4.50    4.61    4.87    5.75</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(minwageNJ$wageAfter)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   5.000   5.050   5.050   5.081   5.050   5.750</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## interquartile range
<span class="kw">IQR</span>(minwageNJ$wageBefore)</code></pre>
<pre><code>## [1] 0.62</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">IQR</span>(minwageNJ$wageAfter)</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## deciles (10 groups)
<span class="kw">quantile</span>(minwageNJ$wageBefore, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))</code></pre>
<pre><code>##   0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
## 4.25 4.25 4.25 4.25 4.50 4.50 4.65 4.75 5.00 5.00 5.75</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">quantile</span>(minwageNJ$wageAfter, <span class="dt">probs =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))</code></pre>
<pre><code>##   0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
## 5.00 5.05 5.05 5.05 5.05 5.05 5.05 5.05 5.05 5.15 5.75</code></pre>
</div>
<div id="standard-deviation" class="section level3">
<h3 class="hasAnchor">
<a href="#standard-deviation" class="anchor"></a>2.6.2: Standard Deviation</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sqrt</span>(<span class="kw">mean</span>((minwageNJ$fullPropAfter -<span class="st"> </span>minwageNJ$fullPropBefore)^<span class="dv">2</span>))</code></pre>
<pre><code>## [1] 0.3014669</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(minwageNJ$fullPropAfter -<span class="st"> </span>minwageNJ$fullPropBefore)</code></pre>
<pre><code>## [1] 0.02387474</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## standard deviation
<span class="kw">sd</span>(minwageNJ$fullPropBefore)</code></pre>
<pre><code>## [1] 0.2304592</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(minwageNJ$fullPropAfter)</code></pre>
<pre><code>## [1] 0.2510016</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## variance
<span class="kw">var</span>(minwageNJ$fullPropBefore)</code></pre>
<pre><code>## [1] 0.05311145</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">var</span>(minwageNJ$fullPropAfter)</code></pre>
<pre><code>## [1] 0.0630018</code></pre>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#chapter-2-causality">Chapter 2: Causality</a><ul class="nav nav-pills nav-stacked">
<li><a href="#section-2-1-racial-discrimination-in-the-labor-market">Section 2.1: Racial Discrimination in the Labor Market</a></li>
      <li><a href="#section-2-2-subsetting-the-data-in-r">Section 2.2: Subsetting the Data in R</a></li>
      <li><a href="#section-2-3-causal-effects-and-the-counterfactual">Section 2.3: Causal Effects and the Counterfactual</a></li>
      <li><a href="#section-2-4-randomized-controlled-trials">Section 2.4: Randomized Controlled Trials</a></li>
      <li><a href="#section-2-5-observational-studies">Section 2.5: Observational Studies</a></li>
      <li><a href="#section-2-6-descriptive-statistics-for-a-single-variable">Section 2.6: Descriptive Statistics for a Single Variable</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jeffey Arnold, Kosuke Imai, Tyler Simko.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
